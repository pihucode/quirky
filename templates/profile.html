{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}

<!-- user can see their QR code and email if logged in -->
{% if user.is_authenticated and user.username == recipient.username %}
  <p>-- Viewing your profile --</p>
  <p>Profile of {{ recipient.username }}</p>
  <p>Email: {{ recipient.email }}</p>
  <p><a href="{% url 'password_reset' %}">change your password</a></p>

  <p>-- Embedded QR --</p>
  {% load qr_code %}
  <img src="{% qr_url_from_text request.build_absolute_uri %}" alt="QR code">

  <div>
    <p><a href="{% url 'home' %}">home</a></p>
    <p><a href="{% url 'logout' %}">logout</a></p>
  </div>

{% else %}
  <!-- NOTE: Remove email after testing -->
  <!-- others should not be able to see a user's email -->
  <p>Email: {{ recipient.email }}</p>

  <!-- NOTE: Optional name field, example: "You are writing to Space Bunny" -->

  <!-- Add form here -->
  <!-- Form **should** send message to user's email without the sender knowing user's email -->
  <form method="post">
      {% csrf_token %}
      {{ form }}
      <div class="form-actions">
        <button type="submit">Send</button>
      </div>
  </form>

  <div>
    <p><a href="{% url 'home' %}">home</a></p>
  </div>
{% endif %}

{% endblock %}
